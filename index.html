<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>منازل الرمال للشقق المخدومة</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Arial', sans-serif;
      direction: rtl;
      background-color: #e9f0f7;
      color: #333;
    }

    header {
      background-color: #1e3a8a;
      color: #f3f4f6;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }

    header h1 {
      margin: 0;
      font-size: 1.2em;
    }

    .menu-toggle {
      display: none;
      font-size: 2em;
      cursor: pointer;
    }

    nav {
      display: flex;
      flex-wrap: wrap;
    }

    nav a {
      color: #f3f4f6;
      margin: 0 10px;
      text-decoration: none;
      font-weight: bold;
      transition: color 0.3s ease;
    }

    nav a:hover {
      color: #a5b4fc;
    }

    @media (max-width: 768px) {
      nav {
        display: none;
        flex-direction: column;
        background-color: #1e3a8a;
        width: 100%;
        text-align: right;
      }

      nav.active {
        display: flex;
      }

      .menu-toggle {
        display: block;
        color: #f3f4f6;
      }

      nav a {
        padding: 10px;
        border-top: 1px solid rgba(243,244,246,0.2);
        margin: 0;
        display: block;
      }

      nav a:first-child {
        border-top: none;
      }

      .units {
        justify-content: center;
      }
    }

    .hero {
      background-image: url('hotel.jpg');
      background-size: cover;
      background-position: center;
      height: 400px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #f3f4f6;
      text-shadow: 2px 2px 6px rgba(0,0,0,0.7);
      font-size: 1.8em;
      padding: 20px;
      text-align: center;
    }

    .units {
      display: flex;
      flex-wrap: wrap;
      justify-content: flex-start;
      gap: 20px;
      padding: 30px 10px;
    }

    .unit {
      background: #ffffff;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      flex: 1 1 calc(25% - 20px);
      min-width: 250px;
      max-width: calc(25% - 20px);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      transition: box-shadow 0.3s ease;
    }

    .unit:hover {
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    }

    .slider {
      position: relative;
      width: 100%;
      height: 200px;
      overflow: hidden;
    }

    .slider img {
      display: none;
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .slider img.active {
      display: block;
      transform: scale(1.05);
    }

    .slider button {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background-color: rgba(30, 58, 138, 0.7);
      color: white;
      border: none;
      font-size: 16px;
      padding: 3px 6px;
      cursor: pointer;
      z-index: 10;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.3s ease;
    }

    .slider button:hover {
      background-color: rgba(30, 58, 138, 0.9);
    }

    .slider .prev { left: 10px; }
    .slider .next { right: 10px; }

    .unit .info {
      padding: 15px;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }

    .unit .info h3 {
      margin-top: 0;
      margin-bottom: 8px;
      color: #1e3a8a;
    }

    .unit .info p {
      margin: 5px 0;
      flex-grow: 1;
      color: #4b5563;
    }

    .unit button {
      background-color: #1e3a8a;
      color: white;
      border: none;
      padding: 10px;
      width: 100%;
      cursor: pointer;
      border-radius: 5px;
      font-size: 1em;
      transition: background-color 0.3s ease;
      margin-top: 10px;
    }
    .unit button:hover {
      background-color: #4338ca;
    }

    .ad-banner {
      margin: 30px auto;
      text-align: center;
      max-width: 100%;
      padding: 20px;
    }

    .ad-banner img,
    .ad-banner video {
      max-width: 60%;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.2);
    }

    .services, .contact, .policies, .testimonials, .location {
      padding: 30px;
      background-color: #f9fafb;
      margin-top: 20px;
      border-radius: 10px;
      max-width: 960px;
      margin-left: auto;
      margin-right: auto;
      color: #374151;
    }

    .services ul, .policies ul {
      list-style: none;
      padding: 0;
      font-size: 1.1em;
      line-height: 1.6em;
    }

    .services li::before {
      content: "✓ ";
      color: #1e3a8a;
      font-weight: bold;
    }

    footer {
      background-color: #1e3a8a;
      color: white;
      text-align: center;
      padding: 15px;
      margin-top: 30px;
      width: 100vw;
      position: fixed;
      bottom: 0;
      left: 0;
      margin-left: 0;
      margin-right: 0;
      border-radius: 0;
      box-sizing: border-box;
    }

    /* البوب أب */
    .popup {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    .popup-content {
      background: white;
      padding: 20px;
      border-radius: 10px;
      position: relative;
      width: 90%;
      max-width: 400px;
      max-height: 80vh;
      overflow-y: auto;
    }

    .close-btn {
      position: absolute;
      top: 10px;
      left: 10px; /* استخدم right: 10px; إذا تبيها في اليمين */
      font-size: 20px;
      font-weight: bold;
      color: #1e3a8a;
      cursor: pointer;
    }

    .popup-content input, .popup-content select {
      width: 90%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 1em;
    }

    .popup-content button {
      background-color: #1e3a8a;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1.1em;
      margin-top: 10px;
      width: 100%;
      transition: background-color 0.3s ease;
    }

    .popup-content button:hover {
      background-color: #4338ca;
    }

    /* نافذة عرض الصورة */
    .image-popup {
      display: none;
      position: fixed;
      z-index: 10000;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.9);
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }

    .image-popup img {
      max-width: 90%;
      max-height: 80vh;
      margin-bottom: 20px;
    }

    .image-popup .close {
      color: white;
      font-size: 30px;
      position: absolute;
      top: 20px; right: 30px;
      cursor: pointer;
      user-select: none;
    }

    .image-popup .nav span {
      color: white;
      font-size: 40px;
      margin: 0 20px;
      cursor: pointer;
      user-select: none;
    }

    /* Responsive styles for booking popup */
    @media (max-width: 480px) {
      .popup-content {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100vw !important;
        height: 100vh !important;
        max-width: none !important;
        padding: 10px !important;
        margin: 0 !important;
        font-size: 1em !important;
        overflow-y: auto !important;
        border-radius: 0 !important;
      }

      .popup-content input,
      .popup-content select,
      .popup-content button {
        width: 100% !important;
        font-size: 1em !important;
        padding: 10px !important;
        box-sizing: border-box !important;
      }

      .popup-content h3 {
        font-size: 1.2em !important;
      }

      #priceDisplay, #totalDisplay {
        font-size: 1em !important;
      }
    }
  </style>
</head>
<body>

  <header>
    <h1>منازل الرمال للشقق المخدومة</h1>

    <div class="menu-toggle" onclick="toggleMenu()">☰</div>

    <!-- روابط التنقل -->
    <nav id="mainNav">
      <a href="#index">الرئيسية</a>
      <a href="#units">الشقق</a>
      <a href="#services">الخدمات</a>
      <a href="#contact">تواصل معنا</a>
    </nav>
  </header>

  <section class="hero">
    منازل الرمال - شقق مخدومة ومريحة للضيوف
  </section>

  <h1>الوحدات المتوفرة</h1>
<div class="units" id="unitsContainer"></div>

  <section id="services" class="services">
    <h2>الخدمات المتوفرة</h2>
    <ul>
      <li>تنظيف يومي للشقق</li>
      <li>خدمة واي فاي مجاني</li>
      <li>مواقف سيارات خاصة</li>
      <li>مطبخ مجهز بالكامل</li>
      <li>خدمة توصيل الطعام</li>
      <li>أمن وحراسة على مدار 24 ساعة</li>
    </ul>
  </section>

  <section id="contact" class="contact">
    <h2>تواصل معنا</h2>
    <p>العنوان: شارع الرمال - المدينة المنورة</p>
    <p>الهاتف: 0501234567</p>
    <p>البريد الإلكتروني: info@manazelrimal.com</p>
    <div class="whatsapp">
      <a href="https://wa.me/966501234567" target="_blank" rel="noopener">اتصل عبر واتساب</a>
    </div>
  </section>
 <section class="location map">
    <h2>موقعنا</h2>
    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d30160.115819721428!2d41.9299328!3d19.1070208!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x15e5009eb40e502b%3A0xc1165cb7a5b60d25!2sRoyal%20Suites%20Aparthotel!5e0!3m2!1sen!2ssa!4v1749115475027!5m2!1sen!2ssa" width="400" height="300" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
  </section>

  
  <footer>
    &copy; 2025 منازل الرمال. جميع الحقوق محفوظة.
  </footer>

  <!-- Popup الحجز -->
   <div id="imagePopup" class="image-popup">
  <span class="close" onclick="closeImagePopup()">×</span>
  <img id="popupImage" src="" alt="عرض الصورة">
  <div class="nav">
    <span class="prev" onclick="showPrevImage()">❮</span>
    <span class="next" onclick="showNextImage()">❯</span>
  </div>
</div>
  <div class="popup" id="popup">
  <div class="popup-content">
    <span class="close-btn" onclick="closePopup()">✖</span>
    <h3>إدخال بيانات الحجز</h3>
    <div id="priceDisplay">السعر: <span id="priceValue"></span> ريال / الليلة</div>
    <form id="bookingForm" action="https://formspree.io/f/mblyldkl" method="POST" onsubmit="handleSubmit(event)">
      <input type="text" name="الاسم الكامل" placeholder="الاسم الكامل" required>
      <input type="number" name="رقم الهوية" placeholder="رقم الهوية" required>
      <label for="date">تاريخ الميلاد</label>
      <input type="date" name="تاريخ الميلاد" required>
      <input type="number" name="رقم نسخة الهوية" placeholder="رقم نسخة الهوية" required>

      <input type="hidden" name="نوع الوحدة" id="unitTypeInput">
      <label for="checkin">تسجيل الوصول</label>
  <input type="date" id="checkin" name="تاريخ الحجز" required>

  <label for="checkout">تسجيل الخروج</label>
  <input type="date" id="checkout" name="تاريخ الخروج" required>
  <div id="totalDisplay">إجمالي الأيام: <span id="daysValue"></span> - المبلغ الإجمالي: <span id="totalValue"></span> ريال</div>
        <input type="email" name="email" placeholder="البريد الإلكتروني" required>

      <button type="submit">تأكيد الحجز والدفع</button>
    </form>
  </div>
</div>

<script>
  function toggleMenu() {
    document.getElementById("mainNav").classList.toggle("active");
  }

  var currentPrice;
  // فتح البوب أب وتعبئة نوع الوحدة
  function openPopup(unitType, price) {
    currentPrice = price;
    document.getElementById("unitTypeInput").value = unitType;
    document.getElementById("priceValue").textContent = price;
    document.getElementById("popup").style.display = "flex";
    document.body.style.overflow = 'hidden'; // disable background scroll
    calculateTotal();
  }

  // إغلاق البوب أب بعد الإرسال (تأخير بسيط لإظهار الإرسال)
  function closePopup() {
    document.getElementById("popup").style.display = "none";
    document.body.style.overflow = ''; // restore background scroll
  }

  let currentImages = [];
  let currentIndex = 0;

  document.querySelectorAll('.slider img').forEach(img => {
    img.addEventListener('click', function () {
      const slider = this.closest('.slider');
      currentImages = Array.from(slider.querySelectorAll('img'));
      currentIndex = currentImages.indexOf(this);
      showImagePopup();
    });
  });

  function showImagePopup() {
    const popup = document.getElementById("imagePopup");
    const popupImage = document.getElementById("popupImage");
    popupImage.src = currentImages[currentIndex].src;
    popup.style.display = "flex";
  }

  function closeImagePopup() {
    document.getElementById("imagePopup").style.display = "none";
  }

  function showPrevImage() {
    currentIndex = (currentIndex - 1 + currentImages.length) % currentImages.length;
    document.getElementById("popupImage").src = currentImages[currentIndex].src;
  }

  function showNextImage() {
    currentIndex = (currentIndex + 1) % currentImages.length;
    document.getElementById("popupImage").src = currentImages[currentIndex].src;
  }

  function calculateTotal() {
    const checkin = document.getElementById('checkin').value;
    const checkout = document.getElementById('checkout').value;
    if (checkin && checkout) {
      const start = new Date(checkin);
      const end = new Date(checkout);
      const diffTime = end - start;
      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
      if (diffDays > 0) {
        document.getElementById('daysValue').textContent = diffDays;
        const total = currentPrice * diffDays;
        document.getElementById('totalValue').textContent = total;
      } else {
        document.getElementById('daysValue').textContent = 'غير صحيح';
        document.getElementById('totalValue').textContent = '0';
      }
    } else {
      document.getElementById('daysValue').textContent = '';
      document.getElementById('totalValue').textContent = '';
    }
  }

  const checkinInput = document.getElementById('checkin');
  const checkoutInput = document.getElementById('checkout');
  if (checkinInput && checkoutInput) {
    checkinInput.addEventListener('change', calculateTotal);
    checkoutInput.addEventListener('change', calculateTotal);
  }
</script>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCvwx3I0gb6UTACYawsaMvYvK0AOCEYgzs",
    authDomain: "booking-3878a.firebaseapp.com",
    databaseURL: "https://booking-3878a-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "booking-3878a",
    storageBucket: "booking-3878a.appspot.com",
    messagingSenderId: "611114717520",
    appId: "1:611114717520:web:4768cb8a7b8465f99fdc55"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const unitsRef = ref(db, "units");
  const unitsContainer = document.getElementById("unitsContainer");

  onValue(unitsRef, (snapshot) => {
    unitsContainer.innerHTML = "";
    if (!snapshot.exists()) {
      unitsContainer.innerHTML = "<p>لا توجد وحدات حالياً.</p>";
      return;
    }

    // تفعيل السلايدر بعد تحميل الوحدات
    setTimeout(() => {
      const sliders = document.querySelectorAll('.slider');

      sliders.forEach(slider => {
        const images = slider.querySelectorAll('img');
        let currentIndex = 0;

        const showImage = (index) => {
          images.forEach((img, i) => {
            img.classList.toggle('active', i === index);
          });
        };

        slider.querySelector('.next').addEventListener('click', () => {
          currentIndex = (currentIndex + 1) % images.length;
          showImage(currentIndex);
        });

        slider.querySelector('.prev').addEventListener('click', () => {
          currentIndex = (currentIndex - 1 + images.length) % images.length;
          showImage(currentIndex);
        });

        showImage(currentIndex); // عرض أول صورة
      });
    }, 100); // تأخير بسيط للتأكد أن كل العناصر ظهرت

    const units = snapshot.val();
    for (const id in units) {
      const unit = units[id];
      const images = unit.images || [];

      const sliderImages = images.map((img, index) =>
        `<img src="${img}" class="${index === 0 ? 'active' : ''}" alt="${unit.title}" />`
      ).join('');

      const card = `
        <div class="unit">
          <div class="slider">${sliderImages}
          </div>
          <div class="info">
            <h3>${unit.title}</h3>
            <p>${unit.description}</p>
            <p>السعر: ${unit.price} ريال / الليلة</p>
            <p>الأفراد: ${unit.capacity}</p>
            <button onclick="openPopup('${unit.title}', ${unit.price})">احجز الآن</button>
          </div>
        </div>
      `;

      unitsContainer.insertAdjacentHTML("beforeend", card);
    }
  });
</script>

<script>
  async function handleSubmit(event) {
    event.preventDefault();
    const form = event.target;
    const formData = new FormData(form);

    // Convert FormData to JSON object
    const data = {};
    formData.forEach((value, key) => {
      data[key] = value;
    });

    try {
      // Send data to Formspree
      const response = await fetch(form.action, {
        method: form.method,
        headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
      });

      if (response.ok) {
        // Redirect to thankyou.html with URL parameters
        const params = new URLSearchParams();
        params.append('name', data['الاسم الكامل'] || '');
        params.append('id', data['رقم الهوية'] || '');
        params.append('birthdate', data['تاريخ الميلاد'] || '');
        params.append('idcopy', data['رقم نسخة الهوية'] || '');
        params.append('unit', data['نوع الوحدة'] || '');
        params.append('checkin', data['تاريخ الحجز'] || '');
        params.append('checkout', data['تاريخ الخروج'] || '');
        params.append('email', data['email'] || '');
        params.append('price', currentPrice);
        params.append('days', document.getElementById('daysValue').textContent);
        params.append('total', document.getElementById('totalValue').textContent);
        window.location.href = 'thankyou.html?' + params.toString();
      } else {
        alert('حدث خطأ أثناء إرسال النموذج. يرجى المحاولة مرة أخرى.');
      }
    } catch (error) {
      alert('حدث خطأ أثناء إرسال النموذج. يرجى المحاولة مرة أخرى.');
      console.error('Error submitting form:', error);
    }
  }
</script>

</body>
</html>
